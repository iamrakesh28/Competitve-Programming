if (self.CavalryLogger) { CavalryLogger.start_js(["9FkTg"]); }

__d("XNotesComposerOnlyPublishController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/notes/composer/onlypublish/",{note_id:{type:"Int"},__asyncDialog:{type:"Int"}})}),null);
__d("NotesReader.react",["ix","cx","fbt","glyph","ActorURI","CampfireByline.react","CssBackgroundImage.react","DOMContainer.react","Image.react","React","TooltipData","UnicodeBidi","UnicodeBidiDirection","Video.react","XNotesComposerOnlyPublishController","XUIButton.react","XUIGrayText.react","XUIOverlayButton.react","XUIText.react","canEditNote","suiMargin","uniqueID"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=b("UnicodeBidiDirection").LTR,l=b("UnicodeBidiDirection").RTL;a=b("React").PropTypes;var m=b("canEditNote")();c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={waitingToEdit:!1},c.$1=function(){c.props.onEdit&&c.setState({waitingToEdit:!0},c.props.onEdit)},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){__p&&__p();var a=null;if(this.props.coverMediaInfo)if(this.props.coverMediaInfo.type==="photo"){var c=this.props.coverMediaInfo,d=c.xOffset;c=c.yOffset;a=b("React").createElement(b("CssBackgroundImage.react"),{imageURI:this.props.coverMediaInfo.coverPhotoURI,className:"_2jzn",backgroundPosition:d+"% "+c+"%"})}else this.props.coverMediaInfo.type==="video"&&(a=b("React").createElement(b("Video.react"),{poster:this.props.coverMediaInfo.posterSrc,src:this.props.coverMediaInfo.videoSrc,width:"100%",height:"100%"}));d=null;if(this.props.ufiMarkup)d=b("React").createElement(b("DOMContainer.react"),null,this.props.ufiMarkup);else if(this.props.canEdit){c=b("XNotesComposerOnlyPublishController").getURIBuilder().setInt("note_id",this.props.noteID).getURI();c=b("ActorURI").create(c,this.props.ownerID);var e=i._("Click the \"Publish\" button to publish. Editing is not available in this browser."),f=null;m&&(e=i._("Click the \"Publish\" button to save or \"Edit\" to make more changes."),f=b("React").createElement(b("XUIButton.react"),{label:i._("Edit"),onClick:this.$1,disabled:this.state.waitingToEdit,size:"xlarge",use:"default",className:"_3-9b _1nvw"}));d=b("React").createElement("div",{className:"_4lmh"},b("React").createElement(b("XUIGrayText.react"),{shade:"medium",display:"block"},i._("This is a preview of your note.")),b("React").createElement(b("XUIGrayText.react"),{shade:"light",display:"block",className:"_3-8w"},e),b("React").createElement("div",{className:"_3-8y"},b("React").createElement(b("XUIButton.react"),{href:c.toString(),rel:"async-post",label:i._("Publish"),size:"xlarge",use:"confirm",className:"_1nvw"}),f))}e=null;this.props.canEdit?m?e=b("React").createElement("div",{className:"_34gr"},b("React").createElement(b("XUIOverlayButton.react"),{image:b("React").createElement(b("Image.react"),{src:g("101440")}),label:this.props.isDoc?i._("Edit Doc"):i._("Edit Note"),onClick:this.$1,disabled:this.state.waitingToEdit})):e=b("React").createElement("div",{className:"_34gr"},b("React").createElement(b("XUIOverlayButton.react"),{image:b("React").createElement(b("Image.react"),{src:g("101440")}),label:i._("Editing is not available in this browser"),disabled:!0})):this.props.isDoc&&(e=b("React").createElement("div",{className:"_34gr"},b("React").createElement(b("XUIOverlayButton.react"),babelHelpers["extends"]({image:b("React").createElement(b("Image.react"),{src:g("101440")}),label:i._("Edit Doc"),disabled:!0},b("TooltipData").propsFor(i._("This document is not editable"),"left")))));c="_4lmi _t04"+(this.props.coverMediaInfo?"":" _t05");f=b("UnicodeBidi").getDirection(this.props.title);f="_4lmk"+(f===k?" _2vxa":"")+(f===l?" _2vxb":"")+" autofocus";var h=b("uniqueID")(),j=null;if(this.props.menuMarkup){var n=this.props.canEdit||this.props.isDoc;n="_16q8"+(this.props.coverMediaInfo?"":" _16q9")+(n?" _16qa":"");j=b("React").createElement("div",{className:n},b("React").createElement(b("DOMContainer.react"),null,this.props.menuMarkup))}return b("React").createElement("div",{className:c,"data-ft":this.props.feedTracking,role:"dialog","aria-labelledby":h},a,b("React").createElement("div",{className:"_39k2"},j,b("React").createElement(b("XUIText.react"),{id:h,tabIndex:-1,type:"serif",display:"block",className:f},this.props.title),b("React").createElement(b("CampfireByline.react"),{authorName:this.props.authorInfo.name,authorProfileURI:this.props.authorInfo.profileURI,authorProfilePicURI:this.props.authorInfo.profilePicURI,dateString:this.props.authorInfo.dateString,permalinkURI:this.props.permalinkURI,privacyMarkup:this.props.privacyMarkup,viewCount:this.props.viewCount})),b("React").createElement(b("XUIText.react"),{type:"serif",display:"block",className:"_39k5"},this.props.children),b("React").createElement("div",{className:"_4lmp"},d),e)};return c}(b("React").Component);c.propTypes={authorInfo:a.object.isRequired,canEdit:a.bool,coverMediaInfo:a.object,feedTracking:a.string,noteID:a.string.isRequired,permalinkURI:a.string.isRequired,privacyMarkup:a.object,onEdit:a.func,ownerID:a.string.isRequired,title:a.string.isRequired,ufiMarkup:a.object,viewCount:a.object,isDoc:a.bool};e.exports=c}),null);
__d("NotesReaderOverlay",["ActorURI","AsyncRequest","BanzaiLogger","CampfireLoggerEvents","CampfireLoggerNoteTypes","DOM","DOMContainer.react","LayerDestroyOnHide","LayerHideOnEscape","LayerHideOnTransition","LayerRefocusOnHide","NotesReader.react","PageTransitions","React","ReactDOM","TypewriterLayer","URI","XNotesComposerController","goURI"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,c){__p&&__p();var d=this;this.$12=function(){d.$13(),d.$6.show()};this.$1=a;this.$2=c;this.$3=b("DOM").create("span");this.$4=null;this.$5=null;this.$6=new(b("TypewriterLayer"))({addedBehaviors:[b("LayerDestroyOnHide"),b("LayerHideOnEscape"),b("LayerHideOnTransition"),b("LayerRefocusOnHide")],causalElement:c.causalElement,className:c.className},this.$3);this.$6.subscribe("hide",this.$7.bind(this));this.$8();!this.$2.canEdit&&this.$2.published&&(this.$9=Date.now())}var c=a.prototype;c.$7=function(){__p&&__p();var a=this;b("PageTransitions").removeHandler(this.$10);this.$10=null;var c=function c(d){var e=a.$4;a.$4=null;b("PageTransitions").removeHandler(c);if(e.getPath()===d.getPath()){b("PageTransitions").transitionComplete(!0);return!0}return!1};b("PageTransitions").registerHandler(c);b("goURI")(this.$4);if(!this.$2.canEdit&&this.$2.published){c=Date.now();var d=Math.round((c-this.$9)/1e3);b("BanzaiLogger").log("CampfireNotesLoggerConfig",{event:b("CampfireLoggerEvents").CONSUME_READER_EXIT_PUBLISHED,event_time:c,note_id:Number(this.$1),note_type:b("CampfireLoggerNoteTypes").CAMPFIRE,author_id:Number(this.$2.authorInfo.ownerID),time_spent_reading_sec:d})}};c.$11=function(){var a=this,c=b("XNotesComposerController").getURIBuilder().getURI();c=b("ActorURI").create(c,this.$2.authorInfo.ownerID);new(b("AsyncRequest"))(c).setData({note_id:this.$1}).setMethod("POST").setHandler(function(){a.$6.hide()}).send()};c.$8=function(){b("ReactDOM").render(b("React").createElement(b("NotesReader.react"),{authorInfo:this.$2.authorInfo,canEdit:this.$2.canEdit,coverMediaInfo:this.$2.coverMediaInfo,feedTracking:this.$2.feedTracking,noteID:this.$1,title:this.$2.title,menuMarkup:this.$2.menuMarkup,onEdit:this.$11.bind(this),ownerID:this.$2.authorInfo.ownerID,permalinkURI:this.$2.permalinkURI,privacyMarkup:this.$2.privacyMarkup,ufiMarkup:this.$2.ufiMarkup,testConfig:this.$2.testConfig,viewCount:this.$2.viewCount},b("React").createElement(b("DOMContainer.react"),{display:"block"},this.$2.documentMarkup)),this.$3,this.$12)};c.$13=function(){__p&&__p();var a=this,c=new(b("URI"))(this.$2.permalinkURI);this.$5=function(d){__p&&__p();if(c.getPath()===d.getPath()){b("PageTransitions").transitionComplete(!0);return!0}if(a.$6.isShown()&&a.$4.getPath()===d.getPath()){b("PageTransitions").removeHandler(a.$5);a.$5=null;a.$4=null;b("PageTransitions").transitionComplete(!0);return!0}a.$5=null;return!1};b("PageTransitions").registerHandler(this.$5);this.$4=b("URI").getRequestURI();b("goURI")(c)};return a}();e.exports=a}),null);